*/ ================================================
    Analyse codes for information
===================================================
/*

SELECT
country,
COUNT(customer_key) As total_customers
FROM gold.dim_customers
Group BY country
ORDER BY total_customers DESC

-- Find total customer by gender
SELECT
gender, 
COUNT(customer_key) As total_customers
FROM gold.dim_customers
Group BY Gender
ORDER BY total_customers DESC

--Find total products by category
SELECT
Category,
COUNT(customer_key) As total_customers
FROM gold.dim_customers
Group BY category
ORDER BY total_customers DESC

--What is the average costs in each category?
SELECT
Category,
AVG(cost)) As avg_costs
FROM gold.dim_customers
Group BY category
ORDER BY total_customers DESC

--What is the total revenue generated for each category?
SELECT
SUM(f.sales_amount) total_revenue,
p.category
FROM gold.fact_sales f
LEFT JOIN gold.dim_products p
ON p.product_key = f.product_key
Group BY p.category
ORDER BY total_customers DESC

--What is the total revenue generated for each category?
SELECT
c.customer_key,
c.First_name,
c.last_name,
SUM(f.sales_amount) total_revenue
FROM gold.fact_sales f
LEFT JOIN gold.dim_customers c
ON p.product_key = f.product_key
Group BY 
c.customer_key,
c.First_name,
c.last_name
ORDER BY total_customers DESC

--What is the distribution of sold itens across countries?
SELECT
c.country,
SUM(f.quantity) as total_sold_itens
FROM gold.fact_sales f
LEFT JOIN gold.dim_customers c
ON c.customer_key = f.customer_key
Group BY 
c.country
ORDER BY total_sold_itens DESC

